# Most of the code borrowed from: https://github.com/nyu-dl/bert-gen/blob/master/bert-babble.ipynb

from nltk.translate import bleu_score as bleu
from tqdm import tqdm, trange
import csv
from collections import Counter
from nltk.util import ngrams


def load_data(dataset_path, indx=1):
    with open(dataset_path, encoding='utf_8') as f:
        f = csv.reader(f)
        output = []
        for line in tqdm(f):
            output.append(line[indx])
    return output



def prepare_data(data_file, replacements={}, indx=1, load_from_csv=True, uncased=True):
    # data = [d.strip().split() for d in open(data_file, 'r').readlines()]
    if load_from_csv:
        data = [d.strip().split() for d in load_data(data_file, indx=indx)]
    else:
        data = [d.strip().split() for d in data_file]

    if uncased:
        data = [[t.lower() for t in sent] for sent in data]

    for k, v in replacements.items():
        data = [[t if t != k else v for t in sent] for sent in data]

    return data


def prepare_wiki(data_file, uncased=True):
    replacements = {"@@unknown@@": "[UNK]"}
    return prepare_data(data_file, replacements=replacements, uncased=uncased)


def prepare_tbc(data_file):
    replacements = {"``": "\"", "\'\'": "\""}
    return prepare_data(data_file, replacements=replacements)


def corpus_bleu(generated, references):
    """ Compute similarity between two corpora as measured by
    comparing each sentence of `generated` against all sentences in `references`

    args:
        - generated (List[List[str]]): list of sentences (split into tokens)
        - references (List[List[str]]): list of sentences (split into tokens)

    returns:
        - bleu (float)
    """
    return bleu.corpus_bleu([references for _ in range(len(generated))], generated)


# DIVERSITY ------------------------------------------


def self_bleu(sents):
    # Compare every single sentece against all other senteces minus the one being compared.
    return bleu.corpus_bleu([[s for (j, s) in enumerate(sents) if j != i] for i in range(len(sents))], sents)


def get_ngram_counts(sents, max_n=4):
    size2count = {}
    for i in range(1, max_n + 1):
        size2count[i] = Counter([n for sent in sents for n in ngrams(sent, i)])
    return size2count


def ref_unique_ngrams(preds, refs, max_n=4):
    # get # of *distinct* pred ngrams that don't appear in ref
    pct_unique = {}
    pred_ngrams = get_ngram_counts(preds, max_n)
    ref_ngrams = get_ngram_counts(refs, max_n)
    for i in range(1, max_n + 1):
        pred_ngram_counts = set(pred_ngrams[i].keys())
        total = sum(pred_ngrams[i].values())
        ref_ngram_counts = set(ref_ngrams[i].keys())
        n_grams_only_in_preds = len(pred_ngram_counts.difference(ref_ngram_counts))
        if n_grams_only_in_preds == 0 or total == 0:
            pct_unique[i] = 0.001
        else:
            pct_unique[i] = n_grams_only_in_preds / total
    return pct_unique


def self_unique_ngrams(preds, max_n=4):
    # get # of pred ngrams with count 1
    pct_unique = {}
    pred_ngrams = get_ngram_counts(preds, max_n)
    for i in range(1, max_n + 1):
        n_unique = len([k for k, v in pred_ngrams[i].items() if v == 1])
        total = sum(pred_ngrams[i].values())
        if n_unique == 0 or total == 0:
            pct_unique[i] = 0.001
        pct_unique[i] = n_unique / total
    return pct_unique


s_path = "/Users/aw678/PycharmProjects/masters_proj/GPT2_experiments/Datasets/lyrics/train_lyrics_small.csv"
# s_scores = self_bleu(prepare_data(s_path))
# print(s_scores)
# path = "/Users/aw678/PycharmProjects/masters_proj/GPT2_experiments/Datasets/lyrics/eval_lyrics_xsmall.csv"
# d_toks = prepare_data(path)
# g_toks = [['baby', 'always', 'look', 'me', 'in', 'the', 'eye', "it's", 'making', 'me', 'sad', 'come', 'on', 'and', 'keep', 'me', 'here', 'baby', 'always', 'look', 'me', 'in', 'the', 'eye', "it's", 'making', 'me', 'sad', 'come', 'on', 'and', 'keep', 'me', 'here', 'in', 'the', 'night', 'i', 'feel', 'it', 'i', 'need', 'you', 'sleep', 'tight', "i'm", 'kissing', 'you', 'all', 'night', "you're", 'with', 'another', 'for', 'if', 'i', 'should', 'let', 'you', 'know', 'that', "i'm", 'hypnotized', 'baby', 'look', 'me', 'in', 'the', 'eye', 'this', 'is', 'a', 'goodbye', 'forever', 'more', 'i', 'want', 'you', 'to', 'stay', 'in', 'the', 'night', 'now', 'baby', 'look', 'me', 'in', 'the', 'eye', "there's", 'not', 'a', 'word', 'about', 'us', 'baby', 'we', 'used', 'to', 'go', 'so', 'long', 'and', 'everything', 'came', 'too', 'close', 'in', 'the', 'darkness', 'of', 'it', 'all', 'now', 'i', 'close', 'my', 'eyes', 'and', 'pass', 'the', 'field', 'and', 'wonder', 'what', 'went', 'wrong', 'lord', 'knows', 'blessed', 'are', 'the', 'dreams', 'i', 'dream', 'a', 'love', 'so', 'real', 'a', 'love', 'so', 'real', 'a', 'love', 'so', 'real', "it's", 'making', 'me', 'sad', 'come', 'on', 'and', 'keep', 'me', 'here', 'lets', 'take', 'this', 'loneliness', 'tonight', 'every', 'moment', 'it', 'surely', 'brings', 'me', 'back', 'feel', 'safe', 'in', 'the', 'night', "it's", 'making', 'me', 'sad', 'come', 'on', 'and', 'show', 'me', 'my', 'love', 'is', 'true', 'come', 'on', 'and', 'keep', 'me', 'here', '...', 'girl', 'look', 'me', 'in', 'the', 'eye...', 'sleeping', 'here', 'now', 'baby', 'look', 'me', 'in', 'the', 'eyes', 'stop'], ['desperation', 'is', 'pain', 'desperation', 'could', 'not', 'deter', 'to', 'bear', 'the', 'forces', 'of', 'destiny', 'across', 'the', 'universe', 'worlds', 'of', 'fire', 'and', 'ice', 'for', 'all', 'time...', 'the', 'beast', 'annihilates', 'its', 'life', 'the', 'universe', 'has', 'arisen', 'in', 'every', "pagan's", 'womb', 'hidden', 'in', 'woods', 'ofmichon', 'the', 'cry', 'leaves', 'are', 'fallin', 'near', 'when', 'all', 'life', 'can', 'be', 'bled.', 'the', 'elements', 'could', 'not', 'be', 'created', 'but', 'the', "gods'", 'will', 'to', 'destroy', 'the', 'human', 'race', 'will', 'rule', 'supreme', 'nazi', 'ideals', 'for', 'the', 'earth', 'and', 'ours', 'our', 'primal', 'instincts', 'are', 'preying', 'our', 'gnaws', 'dissolve', 'in', 'the', 'smallest', 'holes', 'of', 'the', 'human', 'race', 'and', 'the', 'entrance', 'of', 'the', 'blind', 'will', 'unveil', 'as', 'we', 'open', 'our', 'eyes', 'to', 'discover', 'that', 'nothing', 'so', 'captive', 'can', 'control', 'as', 'this', 'is', 'our', 'nature', 'instinct', 'boundless', 'is', 'the', 'earth', 'offensesing', 'thearration', 'engraved', 'our', 'lordship', 'brings', 'ruin', 'to', 'earth', 'in', 'the', 'darkside', 'of', 'presenter', 'kings', 'leaving', 'the', 'destitute', 'to', 'destroy', 'the', 'purest', 'creation', 'the', 'anichrist', 'was', 'born', 'slowly', 'soiled', 'in', 'the', 'rocks', 'of', 'a', 'heart', 'filled', 'with', 'rancid', 'sigh', 'the', 'sky', 'as', 'black', 'as', 'it', 'could', 'be', 'as', 'we', 'open', 'our', 'eyes', 'to', 'discover', 'that', 'nothing', 'so', 'captive', 'can', 'control', 'as', 'this', 'is', 'our', 'nature', 'instinct', 'boundless', 'is', 'the', 'earth', 'shalt', 'not', 'be', 'controlled', 'by', 'oran', 'or', 'catastrophe', 'we', 'have', 'lost', 'touch', 'of', 'fate', 'empty', 'hands', 'which', 'bring', 'ruin', 'to', 'earth', 'and', "you've", 'lost'], ['you', 'should', 'have', 'run', "who's", 'being', 'watched?', "who's", 'paris', 'become?', 'what', 'reason?', 'leave', 'me', 'alone,', 'take', 'me', 'home', 'i', 'feel', 'like', 'dying', 'some', 'load', 'of', 'lead', 'nobody', 'comes', 'throw', 'me', 'in', 'the', 'wind', "can't", 'see,', 'no', 'mercy', 'take', 'me', 'home', 'take', 'me', 'home', 'no', 'one', 'lives', 'take', 'me', 'home', 'could', 'you', 'not', 'believe', "there's", 'someone', 'here,', 'there', 'who', "won't", 'admit', 'it', 'as', 'long', 'as', "we're", 'together', 'hiding', 'all', 'alone', 'under', 'cross', 'that', 'lowering', 'tide', 'false', 'shadows', 'of', 'our', 'past', 'running', 'bright', 'under', 'unknown', 'trees', "there's", 'such', 'emptiness...', 'you', 'should', 'have', 'run', "who's", 'sailing', 'down', 'the', 'sea?', 'if', 'only', 'you', 'can', 'hear', 'the', 'same', 'caroline', 'passing', 'centuries', 'show', 'me', 'more', 'when', 'i', "don't", 'call...', 'paranoia', 'is', 'my', 'tongue', "i'll", 'be', "waitin'", 'on', 'victory...', "i've", 'always', 'had,', 'to', 'be', 'for', 'heros', 'bonded', 'for', 'my', 'comedy', 'for', '15', 'thousand', 'years', "we've", 'faced', 'each', 'other...', 'bonded', 'for', 'my', 'comedy', 'for', 'your', 'majesty', 'you', "can't", 'believe', 'there', 'is', 'someone', 'here,', 'there', 'who', "won't", 'admit', 'it', 'as', 'long', 'as', "we're", 'together', 'hiding', 'all', 'alone', 'under', 'cross', 'that', 'lowering', 'tide', 'false', 'shadows', 'of', 'our', 'past', 'running', 'bright', 'under', 'unknown', 'trees', "there's", 'such', 'emptiness...', 'theenemc', 'briefly', 'whisper', 'than', 'thorns', 'dreams', 'of', 'the', 'day'], ['stay', 'now', 'for', 'what', 'you', 'never', 'said', 'you', 'would', 'perish', 'tonight!', 'thank!', 'now', 'you', 'can', 'take', 'a', 'breath', 'with', 'death.directors!', 'alone', 'in', 'your', 'castle', 'made', 'your', 'bed!', 'scream!', 'behold!nullality', 'gone.', 'cynic!', 'remote', 'control.', 'repair!', 'nevertempest!', "we'll", 'hear', 'from', 'the', 'vultures', 'in', 'your', 'eyes!aken', 'from', 'your', 'castle', 'made', 'your', 'bed!', 'lost', 'memories', 'never', 'running', 'barefoot', 'upon', 'your', 'castle', 'made', 'your', 'bed!', 'knowledge', 'to', 'your', 'holy', 'father', 'and', 'the', 'uhonored', 'magickness', 'gone.', 'now', 'you', 'can', 'take', 'a', 'breath', 'with', 'death.', 'scathingors!', 'alone', 'in', 'your', 'castle', 'made', 'your', 'bed!', 'mortality', 'gone.eoric!', 'remote', 'control.', 'penter', 'built', 'your', 'bed!', 'sing!', 'andy', 'fully!', 'reeking', 'and', 'avoiding!', "you'll", 'be', 'saved!', 'when', 'your', 'twelve', 'winds', 'are', 'sighing!attemptationeducated', 'by', 'these', 'tortures!', "we'll", 'hear', 'from', 'the', 'vultures', 'in', 'your', 'eyes!aken', 'from', 'your', 'castle', 'made', 'your', 'bed!ieving', 'crawl!', 'gott', 'ingly!aign!', 'when', 'your', 'twelve', 'winds', 'are', 'sighing!attemptation', 'staggers!', "we'll", 'hear', 'from', 'the', 'vultures', 'in', 'your', 'eyes!aken', 'from', 'your', 'castle', 'made', 'your', 'bed!', 'lost', 'memories', 'never', 'running', 'barefoot', 'upon', 'your', 'castle', 'made', 'your', 'bed!', 'sightaling', 'death!', 'when', 'the', 'blindfold', 'devil', 'smartstocks', 'the', 'night', 'waiting', 'for', 'me!', 'in', 'this', 'never', 'ending', 'hell', 'awaits', 'no', 'memories.', 'arise!', "we'll", 'hear', 'from', 'the', 'vultures', 'in', 'our', 'eyes!'], ['spareless', 'waters', 'ruces', 'to', 'release', 'their', 'wicked', 'spell', 'deny', 'the', 'standards', 'of', 'ourselves', 'unimaginable', 'the', 'most', 'obvious', 'pstart', 'andushing', 'bull', 'abuse', 'tox', 'patterns', 'and', 'serums', 'steeds', 'ofwithstanding', 'tunation', 'prisoned', 'esteem', 'defending', 'the', 'courses', 'deny', 'the', 'standards', 'of', 'ourselves', 'unimaginable', 'the', 'most', 'obvious', 'sufficiency', 'poem', 'altering', 'thedos', 'tox', 'patterns', 'and', 'serums', 'deny', 'the', 'standards', 'of', 'ourselves', 'unimaginable', 'the', 'most', 'obvious', 'existing', 'in', 'moulding', 'of', 'fire', 'moteliness,', 'sleeping,', 'believing', 'the', 'holiness,', 'is', 'stealing', 'away', 'unlock', 'devourer', 'deny', 'the', 'standard', 'of', 'ourselves', 'unimaginable', 'the', 'most', 'obvious', 'sanity', 'is', 'compromised'], ['this', 'is', 'a', 'moment', "i'm", 'standing', 'here', 'in', 'a', 'crowd', '"don\'t', 'you', 'take', 'my', 'love', 'for', 'granted."', 'i', 'met', 'you', 'on', 'the', 'night', 'i', 'met', 'you', 'you', 'kissed', 'me', 'and', 'told', 'me', 'that', 'you', 'were', 'mine.', 'but', 'this', 'is', 'such', 'a', 'moment', 'i', 'started', 'running', 'back', 'and', 'forth', 'across', 'your', 'heart', 'to', 'find', 'you', 'and', 'make', 'you', 'happy.', 'i', 'started', 'running', 'back', 'and', 'forth', 'across', 'your', 'heart', 'to', 'find', 'you', 'and', 'make', 'you', 'happy.', "don't", 'cry', 'and', 'i', "can't", 'go', 'on', 'for', 'ourselves', 'and', 'i', "can't", 'let', 'go', 'of', 'wondering', 'i', "can't", 'go', 'on', 'being', 'alone...', 'i', "can't", 'stay', 'here', 'for', 'an', 'hour', 'or', 'two', 'but', 'this', 'is', 'such', 'a', 'moment...', 'i', "won't", 'be', 'here', 'today', 'i', "can't", 'go', 'on', 'for', 'myself'], ["i've", 'got', 'a', 'secret', 'of', 'love', "it's", 'the', 'key', 'to', 'the', 'heart', 'in', 'this', 'heart', 'of', 'mine', "it's", 'the', 'key', 'to', 'the', 'heart', 'in', 'this', 'heart', 'of', 'mine', 'do', 'you', 'really', 'want', 'to', 'go', 'with', 'it', "tho'", "there's", 'a', 'future', 'with', 'no', 'seeds', 'at', 'all', 'let', 'me', 'go', 'would', 'knock', 'on', 'your', 'door', 'and', 'somebody', 'pick', 'up', 'the', 'phone', 'who', 'knows', 'what', "you're", 'gonna', 'do', 'if', 'i', 'swore', 'to', 'let', 'it', 'go', "i'd", 'leave', 'you', 'and', 'darling,', "that's", 'what', "i'd", 'like', 'to', 'have', 'when', "i'll", 'be', 'gone?', 'someday', 'baby', "he'll", 'have', 'your', 'love', 'forever', 'someday', 'baby', 'baby', "she'll", 'have', 'your', 'love', 'forever', 'someday', 'baby', 'baby', "she'll", 'have', 'your', 'love', 'forever'], ['why', 'did', 'you', 'call,', 'why', 'did', 'you', 'call', 'me?', 'pinned', 'down', 'on', 'the', 'sidewalk', 'how', 'did', 'you', 'call', 'so', 'suddenly?', 'the', 'way', 'to', 'win', 'a', 'game', 'is', 'it', "'cause", 'i', 'saw', 'you', 'back', 'walking,', 'holding', 'back', 'now', 'that', 'we', 'are', 'here', 'yes', 'i', 'feel', 'about', 'it', 'is', 'it', 'all', 'a', 'play', 'have', 'you', 'found', 'someone', 'to', 'cry?', 'choruseverywhere,', 'yeah', "we'll", 'find', 'someone', 'new', 'all', 'my', 'life', "we'll", 'find', 'a', 'new', 'way', 'everywhere,', 'yeah', "we'll", 'find', 'someone', 'new', 'everywhere,', 'yeah', "we'll", 'find', 'someone', 'new', 'der', 'girlfriend,', 'friend', 'or', 'friend', 'i', 'thought', 'you', 'could', 'be', 'the', 'girl', 'have', 'you', 'found', 'someone', 'who', 'really', 'cares', 'have', 'you', 'found', 'someone', 'to', 'cry?', 'repeat', 'chorus'], ['have', 'you', 'ever', 'met', 'a', 'v-neck', 'lady', 'erg', 'inverted', 'her', 'pale', 'delicate', 'heart', 'and', "she's", 'shed', 'in', 'these', 'very', 'last', 'moments?', 'this', 'moment', 'is', 'the', 'first', 'longest', 'this', 'moment', 'is', 'the', 'last', 'farewell', 'party', 'the', 'fire', "that's", 'burning', 'out', 'of', 'control', 'inct', 'marks', 'yours', 'is', 'all', 'i', 'see', 'i', 'swear', 'no', 'one', 'has', 'ever', 'heard', 'my', 'ears', 'this', 'moment', 'is', 'the', 'last', 'farewell', 'party', 'this', 'moment', 'is', 'the', 'satanest', 'the', 'pledge', 'of', 'allegiance', 'this', 'moment', 'is', 'the', 'fire', "that's", 'burning', 'out', 'of', 'control', 'this', 'moment', 'is', 'the', 'day', 'that', 'you', 'can', 'tell', 'this', 'moment', 'is', 'the', 'night', 'that', 'she', 'sees', 'hear', 'the', 'calling', 'of', 'the', 'sirens', 'armed', 'with', 'sweet', 'surrender', 'this', 'moment', 'is', 'the', 'last', 'farewell', 'party', 'yog-', 'rio', 'shall', 'come', 'this', 'moment'], ['i', 'was', 'a', 'young', 'man', 'just', 'to', 'fall', 'in', 'love', 'with', 'you', 'you', 'were', 'my', 'dream', 'come', 'true', 'i', 'was', 'wrong', 'from', 'the', 'start', 'my', 'heart', 'was', 'full', 'of', 'heartaches', 'no', 'doubt', 'and', 'i', 'was', 'lost', 'in', 'a', 'game', 'of', 'love', 'i', 'could', 'have', 'saved', 'the', 'world', 'i', 'am', 'lost', 'in', 'and', 'out', 'have', 'i', 'failed', 'to', 'tell', 'my', 'friends', 'that', 'i', 'had', 'to', 'let', 'you', 'go', '[chorus]', 'without', 'you', 'i', 'feel', 'for', 'my', 'own', 'good', 'love', 'without', 'you', 'if', 'you', "can't", 'have', 'my', 'love', 'without', 'you', 'why', 'do', 'you', 'need', 'someone', 'before', 'you', 'go', 'without', 'you', 'i', 'feel', 'for', 'my', 'own', 'good', 'love', 'i', 'suffered', 'my', 'loss', 'and', 'grew', 'up', 'and', 'died', 'for', 'you', "i'm", 'begging', 'another', 'broken', 'heart...', '[chorus]'], ["don't", 'call', 'me', 'a', 'tricks', 'fool', "don't", 'you', 'know', "you'll", 'never', 'know', "you'll", 'never', 'believe', "i've", 'met', 'your', 'lover', 'before', "you'd", 'never', 'understand', 'come', 'take', 'me', 'away', "it's", 'the', 'most', 'wonderful', 'time', 'of', 'the', 'year', 'all', 'you', 'must', 'do', 'for', 'me', 'is', 'pray', 'baby', "i'll", 'stay', "don't", 'just', 'ask', 'me', 'for', 'a', 'miracle', 'my', 'heart', 'would', 'never', 'stray', 'from', 'someone', 'you', 'love', "don't", 'fill', 'my', 'new', 'heart', 'with', 'vows', 'baby', "i'll", 'stay', "you'd", 'better', 'cry', 'alone', 'baby', "i'll", 'stay', 'all', 'so', 'long', 'myhand', 'will', 't', 'spy', 'baby', "i'll", 'stay', 'let', 'love', 'surround', 'you', 'baby', "i'll", 'stay', "don't", 'you', 'know', "you'll", 'never', 'know', "don't", 'you', 'miss', 'the', 'sweetest', 'nights', "you've", 'cried', "nothing's", 'worth', 'saving', 'for', 'me', 'baby', "i'll", 'stay', 'and', 'all', 'my'], ['how', 'many', 'roads', 'must', 'a', 'man', 'walk', 'down', 'before', 'a', 'man', 'can', 'walk', 'before', 'he', 'can', 'hear', 'people', 'talk', 'talk', 'about', 'the', 'future', 'ahead', 'just', 'before', 'they', 'have', 'said', 'they', 'were', 'wrong', 'well', 'you', "don't", 'need', 'him', 'or', 'take', 'him', 'to', 'another', 'place', 'when', 'your', "mind's", 'filled', 'with', 'doubt', 'and', 'your', 'courage', 'is', 'shaken', 'you', "can't", 'believe', 'that', 'you', 'faking', 'love', 'as', 'much', 'as', 'you', 'can', 'before', 'you', 'know', 'your', 'heart', 'is', 'feeling', 'hollow', 'the', 'feeling', 'is', 'so', 'strong', 'but', 'your', 'heart', 'is', 'willing', 'to', 'go', 'you', 'can', 'tell', 'this', 'world', 'that', "it's", 'over', 'then', 'you', 'can', 'each', 'in', 'a', 'new', 'way', 'because', 'you', 'have', 'given', 'up', 'on', 'yourself', "you've", 'given', 'up', 'on', 'yourself', 'and', "there's", 'so', 'much', 'power', 'within', 'you', 'tell', 'me', 'to', 'do', 'something', 'wrong', 'for', 'the', 'way', 'that', 'you', 'feel', 'like', 'the', 'things', "you're", 'saying', 'you', 'do', 'go', 'get', 'it', 'up'], ["don't", 'bring', 'music', 'to', 'my', 'lonely', 'heart', 'for', "it's", 'only', 'been', 'two', 'weeks', 'since', 'i', 'met', 'you', 'and', "it's", 'cold', 'in', 'the', 'door', 'and', 'since', "you're", 'not', 'here', 'with', 'me', 'whoa-oh-oh-h', 'h-h-oh', 'come', 'on', 'baby', 'and', 'love', 'me', 'a', 'little', "let's", 'just', 'love', 'each', 'other', 'tomorrow', "don't", 'bring', 'everything', 'to', 'my', 'lonely', 'heart', 'for', "it's", 'only', 'been', 'two', 'weeks', 'since', 'i', 'was', 'happy', 'and', "it's", 'cold', 'in', 'the', 'door', 'and', 'since', "you're", 'not', 'here', 'with', 'me', 'whoa-oh-oh-oh-h-oh', 'when', 'i', "didn't", 'feel', 'out,', 'youletter', 'for', 'i', "couldn't", 'heed', 'your', 'wishes', 'but', "you're", 'there', 'with', 'me', 'once', 'and', "it's", 'cold', 'in', 'the', 'door', 'and', 'since', "you're", 'not', 'here', 'with', 'me', 'whoa-oh'], ["i'm", 'tired,', "i'm", 'weary,', 'each', 'day,', 'through', "life's", 'ups', 'and', 'downs,', 'but', 'i', "can't", 'leave', 'with', 'you,', "we've", 'got', 'to', 'get', 'along', 'somehow,', "i'm", 'not', 'leaving,', "i'm", 'not', 'tormented,', 'i', 'keep', 'right', 'on', "leavin'", 'somehow,', 'i', 'grew', 'my', 'castles', 'with', 'walls', 'around', 'me.', 'i', 'see', 'reflections', 'of', 'you', 'somehow,', 'the', 'memories', 'that', 'you', 'gave', 'me', 'must', 'come', 'back', 'to', 'you,', 'yes', "i'm", 'a', 'fool', 'to', 'think', 'of', 'you,', 'baby,', 'sometimes', 'it', 'hurts', 'to', 'see', 'you', 'smiling,', 'yes', 'i', 'still', "can't", 'live', 'without', 'you,', 'that', 'loveliness,', 'you', 'brought', 'me', 'down', 'and', 'now', "i'm", 'down,', 'i', 'am', 'stronger,', 'cause', 'you', 'brought', 'me', 'down', 'and', 'now', "i'm", 'in,', "i'm", 'stronger,', 'cause', 'you', 'brought', 'me', 'down', 'and', 'now', "i'm", 'in'], ["i'm", 'in', 'love', 'with', 'you', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand', 'doo', "we've", 'made', 'our', 'vows', 'and', 'made', 'how', 'can', 'we', 'break', 'each', 'others', 'down', 'before', "we're", 'too', 'far', 'apart', 'oh', 'as', 'much', 'as', 'i', 'can', 'bear', "i'm", 'in', 'love', 'with', 'you', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand', "i'm", 'in', 'love', 'with', 'you', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand', 'i', 'try', 'so', 'hard', 'to', 'loose', 'and', "i'm", 'all', 'alone', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand', 'before', 'you', 'put', 'your', 'arms', 'around', 'me', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand', "i'm", 'in', 'love', 'with', 'you', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand', 'oh', 'as', 'much', 'as', 'i', 'can', 'stand'], ['forsakenedakened', 'by', 'the', 'light', 'of', 'the', 'moon', 'and', 'the', 'stars,', 'with', 'flickering', 'eyes', 'and', 'ears', 'pushing', 'through', 'the', 'night,', 'for', "it's", 'mosternety.', 'i', 'am', 'waitingebly', 'for', 'you', 'to', 'come', 'home', 'sense', 'of', 'foresight.', 'come', 'with', 'me.', 'let', 'them', 'leave', 'me.', 'let', 'them', 'leave', 'me,', 'let', 'them', 'door', 'to', 'new', 'tomb.', 'will', 'the', 'worms', 'and', 'the', 'worms', 'ever', 'find', 'their', 'home?', 'i', 'call', 'out', 'your', 'name', 'in', 'the', 'night,', 'but', 'your', 'lightse', 'and', 'the', 'sun', 'lies', 'as', 'it', 'calls', 'up', 'in', 'my', 'feelings.', 'please', 'believe!', 'for', 'this', 'we', 'were', 'breaks', 'of', 'space,', 'cared', 'to', 'death.', 'i', 'took', 'your', 'call', 'from', 'the'], ['taken', 'in', 'timebring', 'thefoot', 'storms', 'melted', 'through', 'lullabies', 'and', 'bones', 'surrounded', 'by', 'sleepers', 'sleeping', 'wilderness', 'of', 'the', 'moonlight', 'the', 'wasteland', 'and', 'the', 'mountains', 'sing', 'as', 'they', 'sing', 'seen', 'their', 'souls', 'in', 'a', 'wasteland', 'provide', 'prepared', 'to', 'fight', 'a', 'wasteland', 'field,', 'smokled', 'by', 'strenghten', 'wolves', 'led', 'by', 'the', 'light', 'of', 'day', 'when', 'shadows', 'fall', 'from', 'the', 'night', 'no', 'place', 'to', 'hide', 'peaceful', 'fields', 'of', 'compos', 'secrets', 'in', 'the', 'wasteland', 'of', 'my', 'everlasting', 'memories', 'mould', 'walk', 'through', 'my', 'veins', 'and', 'gems', 'seen', 'their', 'souls', 'in', 'a', 'wasteland', 'isleful', 'sleep', 'parlknarms', "risin'", 'convulse', 'comfort', 'or', 'fail', 'his', 'sight', 'was', 'blind', 'he'], ['wolves', 'share', 'the', 'wolves', 'begging', 'for', 'their', 'lives', 'but', 'their', 'life', 'just', "doesn't", 'suit', 'fair', 'hunters', 'eye', 'chin', 'and', 'drowned', 'in', "kh's", 'tears', 'no', 'sense', 'in', 'the', 'creature', 'that', 'leaves', 'its', 'heart', 'bleeding', 'sleething', 'andarate', 'from', 'its', 'sleep', 'the', 'humans', 'who', 'thought', "they'd", 'be', 'happy,', 'living', 'life', 'with', 'your', 'fear', 'never', 'knowing', 'what', 'its', 'meaning', 'was', 'until', 'it', 'came', 'a', 'hunter', 'instinct', 'angal', 'puppy', 'dog,', 'willwoods', 'prosper', 'no', 'need', 'not', 'to', 'be', 'swayed', 'by', 'animals', 'no', 'need', 'not', 'to', 'be', 'swayed', 'by', 'animals', 'no', 'need', 'not', 'to', 'be', 'swayed', 'by', 'animals'], ["i'm", 'going', 'through', 'hell', 'on', 'hesitating', 'it', 'will', 'bear', 'me', 'down', 'to', 'victory', 'of', "what'll", 'never', 'belong', "i've", 'something', 'to', 'hold', 'on', 'to', 'to', 'pull', 'my', 'knife', 'through', 'the', 'crowd', 'i', 'lack', 'strength', 'to', 'restore', 'someone', 'i', 'am', 'worn', 'as', 'a', 'corpse', 'and', 'i', "could't", 'believe', 'it', 'was', 'me', 'i', 'refuse', 'to', 'do', 'what', 'pleases', 'me', 'i', "don't", 'know', 'to', 'stop', 'like', 'this', 'but', 'still', 'think', 'that', "all's", 'safe', 'here', "i've", 'something', 'to', 'hold', 'on', 'to', 'to', 'pull', 'my', 'knife', 'through', 'the', 'crowd', 'i', 'lack', 'strength', 'to', 'restore', 'someone', 'i', 'am', 'worn', 'as', 'a', 'corpse', 'and', 'i', "could't", 'believe', 'it', 'was', 'me', "there's", 'no', 'a', 'chance', "i'd", 'find', 'a'], ['ii', 'i', 'was', 'standing', 'still', 'waiting', 'for', 'the', 'ocean', 'but', 'i', 'am', 'swimming', 'still', 'dark', 'clouds', 'calling', 'me', 'to', 'where', 'that', 'promise', 'you', 'will', 'always', 'come', 'i', 'was', 'standing', 'still', 'i', 'was', 'standing', 'still', 'and', 'its', 'a', 'close', 'call', 'to', 'its', 'love', 'like', 'i', 'say', 'on', 'its', 'own', 'there', 'always', 'two', 'men', 'in', 'all', 'their', 'lives', 'i', 'would', 'steal', 'that', 'promise', 'but', 'i', 'am', 'swimming', 'still', 'dark', 'clouds', 'calling', 'me', 'to', 'where', 'that', 'promise', 'you', 'will', 'always', 'come', 'i', 'was', 'standing', 'still', 'i', 'was', 'standing', 'still', 'and', 'its', 'a', 'close', 'call', 'to', 'its', 'love', 'like', 'i', 'say', 'on', 'its', 'own', 'there', 'always', 'two', 'men', 'in', 'all', 'their', 'lives', 'i', 'would', 'steal', 'that', 'promise', 'but', 'i', 'am', 'swimming'], ["it's", 'all', 'over', 'your', 'sweetheart,', "it's", 'all', 'over', 'your', 'heart.', 'and', 'i', 'want', 'to', 'stay', 'in', 'your', "lovin'", "'til", 'you', 'come', 'home', 'to', 'me.', "it's", 'all', 'over', 'your', 'sweetheart,', "it's", 'all', 'over', 'your', 'heart.', 'and', 'i', 'want', 'to', 'stay', 'in', 'your', "lovin'", "'til", 'you', 'come', 'home', 'to', 'me.', 'and', "i'm", 'so', 'excited,', 'shock', 'me', 'how', "i'm", 'hypnotized', 'by', 'your', "lovin'", "'til", 'you', 'come', 'home', 'to', 'me.', 'and', 'i', 'want', 'to', 'stay', 'in', 'your', "lovin'", "'til", 'you', 'come', 'home', 'to', 'me.', 'baby,', 'be', 'my', 'sweetheart.', 'and', 'fly', 'away', 'from', 'me', "don't", 'be', 'late', "don't", 'be', 'late.', "don't", 'be', 'lonely.'], ['grayson', '-', "it's", 'boring', 'me', 'i', 'see', 'the', 'day', 'when', 'i', 'first', 'met', 'you', 'i', 'look', 'in', 'your', 'eyes', 'and', 'you', 'say', 'mom', "don't", 'walk', 'away', 'but', 'i', 'let', 'you', 'know', 'how', 'much', 'i', 'love', 'you', 'tell', 'me', 'baby', '-', 'if', 'you', 'have', 'a', 'girl', 'tell', 'me', 'baby', '-', 'if', "you're", 'with', 'her', 'tell', 'me', 'baby', '-', "i'm", 'yours', 'tell', 'me', 'baby', '-', 'if', "it's", 'forever', 'tell', 'me', 'darling', '-', 'how', 'long', 'does', 'it', 'last', 'tell', 'me', 'baby', '-', 'if', 'i', 'need', 'you', 'say', 'i', 'may', 'not', 'see', 'your', 'face', 'in', 'your', 'eyes', 'but', 'i', 'love', 'you', 'and', 'i', 'need', 'you', 'to', 'stay', 'tell', 'me', 'baby', '-', 'if', 'you', 'have', 'a', 'girl', 'tell', 'me', 'baby', '-', 'if', 'the', 'good', 'times', 'are', 'good', 'tell', 'me', 'baby', '-', 'if', 'you', 'have', 'a', 'girl', 'tell', 'me', 'baby', '-', 'if', 'you', "don't", 'have', 'a', 'girl', 'tell', 'me', 'anything', '-', 'if', 'you', 'do', 'the', 'things', 'you', 'want', 'to', 'do', 'let', 'me', 'know', 'when', 'to', 'say', 'that', 'i', 'love', 'you', 'tell', 'me', 'baby', '-', 'if', "it's", 'forever', 'tell', 'me', 'baby', '-', 'if', 'i', 'need', 'you', 'say', 'tell', 'me'], ['sometimes', 'i', 'look', 'as', 'though', 'there', 'is', 'nothing', 'there', 'to', 'explain', 'it', 'makes', 'me', 'want', 'to', 'live,', 'sometimes', 'i', 'look', 'at', 'myself,', 'in', 'sadness,', 'the', 'sadness', 'sometimes', 'i', 'see', 'other', 'faces', 'staring', 'in', 'her', 'eyes', 'i', 'can', 'see', 'that', 'her', 'face', 'from', 'across', 'the', 'room.', 'herself', 'standing', 'in', 'front', 'of', 'me', 'in', 'a', 'mirror', 'i', 'know', 'that', 'she', 'leaves', 'me', 'a', 'choice,', 'and', 'seems', 'to', 'be', 'true', 'to', 'my', 'ownolo', 'different', 'from', 'the', 'misery', 'that', 'i', 'feel.', 'okitions', 'of', 'my', 'thoughts', 'make', 'me', 'no', 'other', 'my', '-', 'my', 'own', 'forher', '-', 'not', 'her', 'voice', 'different', 'from', 'the', 'misery', 'that', 'i', 'feel.', 'as', 'i', 'saw', 'the', 'sadness', 'in', 'her', 'eyes...', 'drawing', 'me', 'closer,drawing', 'me', 'closer,drawing', 'me', 'closer', 'lichy', 'feeling', 'just', 'the', 'same.', 'drowning', 'in', 'a', 'different', 'place.', 'my', 'life', 'is', 'not', 'my', 'own', '-', "i'm", 'not', 'her', 'love', 'if', 'i', 'could', 'find', 'the', 'strength', 'to', 'hold', 'her', 'it', 'would', 'be', 'something', 'other', 'than', 'this.', 'mine...', 'i', 'see', 'she', 'comprehension', 'standing', 'in', 'front', 'of', 'me', 'in', 'a', 'mirror'], ["i've", 'heard', 'whispers', 'through', 'thick', 'and', 'thin', "i'm", 'searching', 'within', 'searching', 'for', 'answers', 'i', 'look', 'at', 'you', 'unafraid', 'for', 'a', 'sense', 'of', 'direction', 'is', 'it', 'right', 'or', 'wrong?', 'i', 'guess', 'i', "don't", 'know', 'oh,', 'please', "don't", 'tell', 'me', "you're", 'not', 'alone', 'i', 'feign', 'like', 'a', 'prey', "i'm", 'understanding', 'now', 'oh', 'like', 'a', 'dream', "i'm", 'walking', 'with', 'myself', 'through', 'thick', 'and', 'thin', 'knowing', 'nothing', 'and', 'not', 'never', 'knowing', 'what', 'it', 'means', 'for', 'a', 'sense', 'of', 'direction', 'is', 'it', 'right', 'or', 'wrong?', 'the', 'speed', 'of', 'sound', 'so', 'when', "you're", 'barely', 'touching', 'the', 'ground', 'feign', 'like', 'a', 'prey', "i'm", 'understanding', 'now', 'oh', 'like', 'a', 'dream', 'oh', 'like', 'a', 'dream', 'ndlever,', "you're", 'torturing', 'me', 'stop', 'and', 'stare', 'oh,', 'please', "don't", 'tell', 'me', "you're", 'not', 'alone', 'i', 'feign', 'like', 'a', 'prey', "i'm", 'understanding', 'now', 'oh', 'like', 'a', 'dream', 'well', 'if', 'you', 'are', 'fallen', 'down', 'would', 'you', 'look', 'right', 'on', 'me?', 'will', 'you', 'turn', 'on', 'my', 'face?'], ['the', 'world', 'around', 'me', 'decided,', 'they', 'said', 'i', 'would', 'forget', 'but', 'my', 'heart', 'said', 'no.', 'my', 'love', 'would', 'turn', 'to', 'ashes,', 'and', 'the', 'sun', 'will', 'set', 'my', 'foolish', 'heart.', 'tomorrow', 'may', 'be', 'eternity', 'but', 'my', 'hope', 'will', 'never', 'cease.', 'my', 'love', 'will', 'forever', 'keep,', 'and', 'the', 'sun', 'will', 'set', 'my', 'foolish', 'heart.', 'tomorrow', 'may', 'be', 'eternity', 'but', 'my', 'hope', 'will', 'never', 'cease.', 'tomorrow', 'may', 'be', 'eternity', 'but', 'my', 'hope', 'will', 'never', 'cease.', 'farther', 'within,', 'it', 'carried', 'me', 'along', 'so', 'long.', 'farther', 'within,', 'it', 'carried', 'me', 'along', 'so', 'long.', 'farther', 'within,', 'it', 'carried', 'me', 'along', 'so', 'long.', 'daddy', 'used', 'to', 'walk', 'with', 'me,', 'and', 'i', 'followed', 'him', 'through', 'the', 'lies,', 'i', 'followed', 'him', 'through', 'this', 'pain,', 'my', 'days', 'were', 'empty,', 'with', 'my', 'pride.', 'and', 'without', 'his', 'happy', 'smile.', '[', 'trans.]', 'and', 'without', 'his', 'happy', 'smile.', '[real:]today', 'may', 'be', 'eternity', 'but', 'my', 'hope', 'will', 'never', 'cease.', 'farther', 'within.'], ['dear', "tuesday's", 'the', 'best', 'time', 'of', 'my', 'life', 'my', 'wife', 'brought', 'him', 'to', 'the', 'table', 'and', 'said', 'that', "she'd", 'like', 'me', 'and', 'my', 'kids', 'always', 'told', 'me', 'oh', 'last', 'night', 'together', 'we', 'began', 'not', 'to', 'see', 'her', 'fuss', 'and', 'fight', 'but', 'we', 'kept', 'up', 'doing', 'things', 'we', "couldn't", 'say', 'and', 'blood', 'money', 'talks', 'over', 'and', 'over', 'we', 'just', 'stopped', 'off', 'at', 'a', 'stop', 'and', 'the', 'nightreason', 'is', 'breaking', 'i', 'went', 'downtown', 'to', 'my', 'join', 'band', 'and', 'took', 'my', 'friends', 'out', 'when', 'i', 'teased', "i'd", 'danced', 'before', 'we', 'came', 'and', 'up', 'there', 'i', 'kept', 'dancing', 'looking', 'for', 'my', 'hero', 'wondering', 'what', 'he', 'had', 'to', 'say', 'last', 'night', 'together', 'we', 'began', 'not', 'to', 'see', 'her', 'fuss', 'and', 'fight', 'but', 'we', 'kept', 'up', 'doing', 'things', 'we', "couldn't", 'say', 'and', 'blood', 'money', 'talks', 'over', 'and', 'over', 'we', 'just', 'stopped'], ['hark!', 'herald', 'angels', 'sing', 'in', 'heaven', 'sing.', 'glory', 'to', 'earth', 'and', 'praising', 'him,', 'god', 'is', 'our', 'king;', 'they', 'hark', 'in', 'heaven', 'sing.', 'hark!', 'herald', 'angels', 'sing', 'in', 'heaven', 'sing.', 'bow', 'up', 'before', 'him,', 'the', 'king', 'of', 'angels,', 'who', 'bled', 'and', 'died', 'for', 'me.', 'hark!', 'herald', 'angels', 'sing', 'in', 'heaven', 'sing.', 'come', 'let', 'us', 'adore', 'him,', 'thee,', 'right', 'on', 'earth,', 'rock,', 'thy', 'glory', 'above,', 'hark!', 'herald', 'angels', 'sing', 'in', 'heaven', 'sing.', 'hark!', 'herald', 'angels', 'sing', 'in', 'heaven', 'sing.', 'hark!', 'herald', 'angels', 'sing', 'in', 'heaven', 'sing.', 'glory', 'to', 'earth', 'and', 'praise', 'him,', 'god', 'is', 'our', 'king,', 'they', 'hark', 'in', 'heaven', 'sing.'], ['this', 'is', 'funny', 'how', 'things', 'come', 'to', 'this', 'way', 'they', 'often', 'speak', 'of', 'giving', 'things', 'away', 'flavorsing', 'the', 'reasons', 'for', 'living', 'the', 'away', 'now', 'i', 'learned', 'to', 'walk', 'without', 'any', 'seeds', 'to', 'sow', 'and', 'now', "i'm", 'learning', 'to', 'control', 'why', 'does', 'life', 'seem', 'so', 'empty', 'when', "you're", 'laid', 'to', 'rest', 'to', 'think', 'that', "i'm", 'grown', 'from', 'walking', 'out', 'of', 'loving', 'you', 'you', 'think', "i'd", 'do', 'so', 'much', 'wrong', 'and', 'then', 'i', 'got', 'to', 'being', 'by', 'your', 'side', 'why', 'does', 'life', 'seem', 'so', 'empty', 'when', "you're", 'laid', 'to', 'rest', 'now', 'this', 'little', 'heart', 'knows', 'just', 'where', 'it', 'should', 'turn', 'but', 'when', 'i', 'come', 'to', 'pass', 'with', 'life', "i'll", 'be', 'passed', 'by', 'you', 'no', 'future', 'plans', 'will', 'come', 'when', "you'll", 'have', 'someone', 'sweet', 'to', 'think', 'that', "i'm", 'grown', 'from', 'walking', 'out', 'of', 'loving', 'you', 'why', 'does', 'life', 'seem', 'so', 'empty', 'when', "you're", 'laid', 'to'], ['the', 'dark', 'had', 'pined', 'with', 'the', 'light', 'of', 'a', 'midnight', 'train', 'the', 'last', 'train', 'i', 'ever', 'had,', 'she', 'set', 'out', 'on', 'the', 'wacht', 'but', 'myester', 'swept', 'at', 'the', 'door,', 'and', 'the', 'night', 'came', 'at', 'last', 'she', 'closed', 'her', 'eyes', 'and', 'whispered', 'low', 'her', 'heart', 'and', 'her', 'hand', 'softly', 'it', 'beat', 'with', 'my', "painter's", 'hand', 'outside', 'she', 'stood', 'there', 'beside', 'him', 'and', 'my', 'shadow,', 'my', 'shadow', 'she', 'filled', 'him', 'with', 'so', 'much', 'love', 'with', 'his', 'touch', 'as', 'the', 'night', 'grieved', 'and', 'the', 'freight', 'raked', 'and', 'the', 'train', 'raked', 'she', 'closed', 'her', 'eyes', 'and', 'whispered', 'low', 'her', 'heart', 'and', 'her', 'hand', 'softly', 'it', 'beat', 'with', 'my', "painter's", 'hand'], ['keep', 'a', 'close', 'watch', 'on', 'me', "you're", 'radical', 'in', 'my', 'heart', "i've", 'got', 'the', 'strength', 'to', 'be', 'a', 'handle', 'over', 'you', 'though', 'you', 'say', 'you', 'jail', 'me', 'every', 'day', "that's", 'the', 'bail', "i'm", 'gonna', 'catch', 'me', 'if', 'you', 'can', 'keep', 'out', 'the', 'fire', 'keep', 'out', 'the', 'flames', 'i', 'got', 'a', 'no', 'time', 'to', 'pack', 'it', 'if', 'you', "can't", 'make', 'it', 'i', "won't", 'be', 'waiting', 'for', 'it', 'if', 'you', "can't", 'make', 'it', 'i', "won't", 'be', 'shaking', 'be', "alockin'", 'and', 'a', "losin'", 'we', 'could', 'be', 'friends', 'till', 'we', 'come', 'together', 'i', 'know', "it's", 'a', 'two', 'way', 'street', 'get', 'a', "driftin'", 'and', 'a', "goin'", 'down', 'on', 'me', 'you', 'can', 'tell', 'your', 'troubles', 'to', 'me', 'i', 'got', 'the', 'urge', 'to', 'call', 'you', 'farewell', "i'll", 'give', 'you', 'hell', 'no', 'matter', 'whatrebels', 'do']]
# max_n = 4
#
# xd = ref_unique_ngrams(g_toks, d_toks, max_n)
# xdd = self_unique_ngrams(g_toks, max_n)

#
#
#
# max_n = 4
# pct_uniques = self_unique_ngrams(bleu_tokenized, max_n)
# for i in range(1, max_n + 1):
#     print("GPT2 unique %d-grams relative to self: %.2f" % (i, 100 * pct_uniques[i]))

# --------------------------------------- TEST
# gens = "/Users/aw678/PycharmProjects/masters_proj/GPT2_experiments/generated_lyrics/gpt2_12-06-2019@11'06/generated_lyrics.csv"
# gen_tokenized = prepare_data(gens)
# gen_uniques = self_unique_ngrams(gen_tokenized, max_n)
# for i in range(1, max_n + 1):
#     print("GPT2 unique %d-grams relative to self: %.2f" % (i, 100 * gen_uniques[i]))
